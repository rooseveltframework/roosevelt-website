<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><title>Roosevelt web framework — SSR web components — usage</title><meta name=description content="The easiest web framework to learn and build apps with — Roosevelt is a web framework for Node.js based on Express that aims to reduce the complexity of your code as much as possible."><script>window.addEventListener('error', (event) => { if (event?.target?.tagName === 'LINK') { window.linkTagError = true } }, true)</script><link rel=preload href=/css/global.css as=style><link rel=preload href=/js/global.js as=script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Montserrat&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Oswald:wght@300;400&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel=stylesheet><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-48x48.png sizes=48x48><link rel=icon type=image/png href=/images/favicon-64x64.png sizes=64x64><link rel=icon type=image/png href=/images/favicon-128x128.png sizes=128x128><link rel=stylesheet href=/css/global.css><script src=/js/global.js defer></script><link rel=preload href=/css/main.css as=style><link rel=preload href=/js/main.js as=script><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/highlight.js.light.css><link rel=stylesheet href=/css/highlight.js.dark.css media="(prefers-color-scheme: dark)"><script src=/js/main.js defer></script></head><body class=no-js id=progressively-enhance-web-components-ssr-web-components-—-usage><main><header><h1><a href=/ >Roosevelt</a></h1><h2>SSR web components — usage</h2><div id=nav-search-wrapper><nav id=fancy-version-picker hidden><form class=semanticForms><dl><dt><label for=version>API version</label></dt><dd><select id=version><option value=/docs/progressively-enhance-web-components/latest/usage.html selected>1.0.4 (latest)</option><option value=https://github.com/rooseveltframework/progressively-enhance-web-components/commits/main/README.md>Older...</option></select></dd></dl></form></nav><search hidden><form id=searchForm action=https://github.com/search method=get class=semanticForms><dl><dt><label for=search>Search</label></dt><dd><input type=text id=search name=q placeholder="e.g. Teddy"></dd></dl><menu class=visuallyHidden><li><button type=submit name=submit>Search</button></li></menu></form></search></div><button command=show-modal commandfor=nav hidden>Site navigation</button></header><div class=content><nav id=pages><dialog id=nav><form method=dialog><button>Close</button></form><h2>About</h2><ul><li><a href=/design-philosophy>Design philosophy</a></li><li><a href=/contributors>Contributors</a></li></ul><h2>Usage</h2><ul><li><a href=/docs/latest/get-started>Get started</a></li><li><a href=/docs/latest/coding-apps>Coding apps</a></li><li><a href=/docs/latest/configuration>Configuration</a></li><li><a href=/docs/latest/deployment>Deployment</a></li><li><a href=https://github.com/orgs/rooseveltframework/discussions>Discussion forum</a></li><li><a href=/docs/latest/changelog>Changelog</a></li><li><a href=https://github.com/orgs/rooseveltframework>GitHub</a></li></ul><h2>Roosevelt project family</h2><hr><ul><li><details><summary><a href=/docs/check-if-CSS-is-disabled/latest/ >Check if CSS is disabled</a></summary><ul><li><a href=/docs/check-if-CSS-is-disabled/latest/usage>Usage</a></li><li><a href=/docs/check-if-CSS-is-disabled/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/check-if-CSS-is-disabled>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/crossplatform-killport/latest/ >Crossplatform killport</a></summary><ul><li><a href=/docs/crossplatform-killport/latest/usage>Usage</a></li><li><a href=/docs/crossplatform-killport/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/crossplatform-killport>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/express-browser-reload/latest/ >Express browser reloader</a></summary><ul><li><a href=/docs/express-browser-reload/latest/usage>Usage</a></li><li><a href=/docs/express-browser-reload/latest/configuration>Configuration</a></li><li><a href=/docs/express-browser-reload/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/express-browser-reload>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/express-html-validator/latest/ >Express HTML validator</a></summary><ul><li><a href=/docs/express-html-validator/latest/usage>Usage</a></li><li><a href=/docs/express-html-validator/latest/configuration>Configuration</a></li><li><a href=/docs/express-html-validator/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/express-html-validator>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/fallback-dependencies/latest/ >Fallback dependencies</a></summary><ul><li><a href=/docs/fallback-dependencies/latest/usage>Usage</a></li><li><a href=/docs/fallback-dependencies/latest/configuration>Configuration</a></li><li><a href=/docs/fallback-dependencies/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/fallback-dependencies>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/minify-html-attributes/latest/ >HTML attribute minifier</a></summary><ul><li><a href=/docs/minify-html-attributes/latest/usage>Usage</a></li><li><a href=/docs/minify-html-attributes/latest/configuration>Configuration</a></li><li><a href=/docs/minify-html-attributes/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/minify-html-attributes>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/multi-db/latest/ >Multi-DB</a></summary><ul><li><a href=/docs/multi-db/latest/usage>Usage</a></li><li><a href=/docs/multi-db/latest/configuration>Configuration</a></li><li><a href=/docs/multi-db/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/multi-db>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/node-php-runner/latest/ >Node.js PHP runner</a></summary><ul><li><a href=/docs/node-php-runner/latest/usage>Usage</a></li><li><a href=/docs/node-php-runner/latest/configuration>Configuration</a></li><li><a href=/docs/node-php-runner/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/node-php-runner>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/roosevelt-logger/latest/ >Roosevelt logger</a></summary><ul><li><a href=/docs/roosevelt-logger/latest/usage>Usage</a></li><li><a href=/docs/roosevelt-logger/latest/configuration>Configuration</a></li><li><a href=/docs/roosevelt-logger/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/roosevelt-logger>GitHub</a></li></ul></details></li><li><details open><summary><a href=/docs/progressively-enhance-web-components/latest/ ><abbr title="server-side render">SSR</abbr> web components</a></summary><ul><li><a href=/docs/progressively-enhance-web-components/latest/usage>Usage</a></li><li><a href=/docs/progressively-enhance-web-components/latest/configuration>Configuration</a></li><li><a href=/docs/progressively-enhance-web-components/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/progressively-enhance-web-components>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/semantic-forms/latest/ >Semantic Forms</a></summary><ul><li><a href=/docs/semantic-forms/latest/usage>Usage</a></li><li><a href=/docs/semantic-forms/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/semantic-forms>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/single-page-express/latest/ >Single Page Express</a></summary><ul><li><a href=/docs/single-page-express/latest/usage>Usage</a></li><li><a href=/docs/single-page-express/latest/configuration>Configuration</a></li><li><a href=/docs/single-page-express/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/single-page-express>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/source-configs/latest/ >Source Configs</a></summary><ul><li><a href=/docs/source-configs/latest/usage>Usage</a></li><li><a href=/docs/source-configs/latest/configuration>Configuration</a></li><li><a href=/docs/source-configs/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/source-configs>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/teddy/latest/ >Teddy templating engine</a></summary><ul><li><a href=/docs/teddy/latest/usage>Usage</a></li><li><a href=/docs/teddy/latest/configuration>Configuration</a></li><li><a href=/docs/teddy/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/teddy>GitHub</a></li></ul></details></li></ul></dialog></nav><article><p>We will demo this technique end-to-end using a <code>&lt;word-count&gt;</code> component that counts the number of words a user types into a <code>&lt;textarea&gt;</code>.</p><p>Suppose the intended use of the <code>&lt;word-count&gt;</code> component looks like this:</p><pre><code class="html language-html">&lt;word-count text="Once upon a time... " id="story"&gt;
  &lt;p slot="description"&gt;Type your story in the box above!&lt;/p&gt;
&lt;/word-count&gt;</code></pre><p>And suppose also that you have an Express application with templates loaded into <code>mvc/views</code>.</p><p>To leverage this module's progressive enhancement technique, you will need to define this component using a <code>&lt;template&gt;</code> element in any one of your templates as follows:</p><pre><code class="html language-html">&lt;template id="word-count"&gt;
  &lt;style&gt;
    div {
      position: relative;
    }
    textarea {
      margin-top: 35px;
      width: 100%;
      box-sizing: border-box;
    }
    span {
      display: block;
      position: absolute;
      top: 0;
      right: 0;
      margin-top: 10px;
      font-weight: bold;
    }
  &lt;/style&gt;
  &lt;div&gt;
    &lt;textarea rows="10" cols="50" name="${id}" id="${id}"&gt;${text}&lt;/textarea&gt;
    &lt;slot name="description"&gt;&lt;/slot&gt;
    &lt;span class="word-count"&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/template&gt;</code></pre><p><em>Note: Any <code>${templateLiterals}</code> present in the template markup will be replaced with attribute values from the custom element invocation. More on that below.</em></p><p>Then, in your Express application:</p><pre><code class="javascript language-javascript">const fs = require('fs-extra')

// load progressively-enhance-web-components.js
const editedFiles = require('progressively-enhance-web-components')({
  templatesDir: './mvc/views'
})

// copy unmodified templates to a modified templates directory
fs.copySync('mvc/views', 'mvc/.preprocessed_views')

// update the relevant templates
for (const file in editedFiles) {
  fs.writeFileSync(file.replace('mvc/views', 'mvc/.preprocessed_views'), editedFiles[file])
}

// configure express
const express = require('express')
const app = express()
app.engine('html', require('teddy').__express) // set teddy as view engine that will load html files
app.set('views', 'mvc/.preprocessed_views') // set template dir
app.set('view engine', 'html') // set teddy as default view engine

// start the server
const port = 3000
app.listen(port, () =&gt; {
  console.log(`🎧 express sample app server is running on http://localhost:${port}`)
})</code></pre><p><em>Note: The above example uses the <a href=https://rooseveltframework.org/docs/teddy>Teddy</a> templating system, but you can use any templating system you like.</em></p><p>In the above sample Express application, the <code>mvc/views</code> folder is copied to <code>mvc/.preprocessed_views</code>, then any template files in there will be updated to replace any uses of <code>&lt;word-count&gt;</code> with a more progressive enhancement-friendly version of <code>&lt;word-count&gt;</code> instead.</p><p>So, for example, any web component in your templates that looks like this:</p><pre><code class="html language-html">&lt;word-count text="Once upon a time... " id="story"&gt;
  &lt;p slot="description"&gt;Type your story in the box above!&lt;/p&gt;
&lt;/word-count&gt;</code></pre><p>Will be replaced with this:</p><pre><code class="html language-html">&lt;word-count text="Once upon a time... " id="story"&gt;
  &lt;div&gt;
    &lt;textarea rows="10" cols="50" name="story" id="story"&gt;Once upon a time... &lt;/textarea&gt;
    &lt;span class="word-count"&gt;&lt;/span&gt;
  &lt;/div&gt;
  &lt;p slot="description"&gt;Type your story in the box above!&lt;/p&gt;
&lt;/word-count&gt;</code></pre><p>The fallback markup is derived from the <code>&lt;template&gt;</code> element and is inserted into the "light DOM" of the web component, so it will display to users with JavaScript disabled.</p><p>Because the <code>&lt;template&gt;</code> element has <code>${templateLiteral}</code> values for the <code>name</code> attribute, the <code>id</code> attribute, and the contents of the <code>&lt;textarea&gt;</code>, those values are prefilled properly on the fallback markup.</p><p>Any tag in the <code>&lt;template&gt;</code> element that has a <code>slot</code> attribute will be moved to the top level of the fallback markup DOM because that is a requirement for the web component to work when JavaScript is enabled. That's why the <code>&lt;p&gt;</code> tag is not a child of the <code>&lt;div&gt;</code> in the replacement example like it is in the <code>&lt;template&gt;</code>. That is done intentionally by this module's preprocessing.</p><p>Then, once the frontend JavaScript takes over, the web component can be progressively enhanced into the JS-driven version.</p><p>Here's an example implementation for the frontend JS side:</p><pre><code class="javascript language-javascript">class WordCount extends window.HTMLElement {
  connectedCallback () { // called whenever a new instance of this element is inserted into the dom
    this.shadow = this.attachShadow({ mode: 'open' }) // create and attach a shadow dom to the custom element
    this.shadow.appendChild(document.getElementById('word-count').content.cloneNode(true)) // create the elements in the shadow dom from the template element

    // set textarea attributes
    const textarea = this.shadow.querySelector('textarea')
    textarea.value = this.getAttribute('text') || ''
    textarea.id = this.getAttribute('id') || ''
    textarea.name = this.getAttribute('id') || ''

    // function for updating the word count
    const updateWordCount = () =&gt; {
      this.shadow.querySelector('span').textContent = `Words: ${textarea.value.trim().split(/\s+/g).filter(a =&gt; a.trim().length &gt; 0).length}`
    }

    // update count when textarea content changes
    textarea.addEventListener('input', updateWordCount)
    updateWordCount() // update it on load as well
  }
}

window.customElements.define('word-count', WordCount) // define the new element</code></pre><p>Once that JS executes, the "light DOM" fallback markup will be hidden and the JS-enabled version of the web component will take over and behave as normal.</p><h3 id=sampleapp>Sample app</h3><p>See an end-to-end demo of this by running the sample app:</p><ul><li><code>cd sampleApps/express</code></li><li><code>npm ci</code></li><li><code>cd ../../</code></li><li><code>npm run express-sample</code><ul><li>Or <code>npm run sample</code></li><li>Or <code>cd</code> into <code>sampleApps/express</code> and run <code>npm ci</code> and <code>npm start</code></li></ul></li><li>Go to <a href=http://localhost:3000>http://localhost:3000</a><ul><li>The page with the web component is located at <a href=http://localhost:3000/pageWithForm>http://localhost:3000/pageWithForm</a></li></ul></li></ul></article></div><footer><nav id=secondary-nav><details open><summary>Site map</summary><h2>About</h2><ul><li><a href=/design-philosophy>Design philosophy</a></li><li><a href=/contributors>Contributors</a></li></ul><h2>Usage</h2><ul><li><a href=/docs/latest/get-started>Get started</a></li><li><a href=/docs/latest/coding-apps>Coding apps</a></li><li><a href=/docs/latest/configuration>Configuration</a></li><li><a href=/docs/latest/deployment>Deployment</a></li><li><a href=https://github.com/orgs/rooseveltframework/discussions>Discussion forum</a></li><li><a href=/docs/latest/changelog>Changelog</a></li><li><a href=https://github.com/orgs/rooseveltframework>GitHub</a></li></ul><h2>Roosevelt project family</h2><hr><ul><li><details><summary><a href=/docs/check-if-CSS-is-disabled/latest/ >Check if CSS is disabled</a></summary><ul><li><a href=/docs/check-if-CSS-is-disabled/latest/usage>Usage</a></li><li><a href=/docs/check-if-CSS-is-disabled/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/check-if-CSS-is-disabled>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/crossplatform-killport/latest/ >Crossplatform killport</a></summary><ul><li><a href=/docs/crossplatform-killport/latest/usage>Usage</a></li><li><a href=/docs/crossplatform-killport/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/crossplatform-killport>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/express-browser-reload/latest/ >Express browser reloader</a></summary><ul><li><a href=/docs/express-browser-reload/latest/usage>Usage</a></li><li><a href=/docs/express-browser-reload/latest/configuration>Configuration</a></li><li><a href=/docs/express-browser-reload/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/express-browser-reload>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/express-html-validator/latest/ >Express HTML validator</a></summary><ul><li><a href=/docs/express-html-validator/latest/usage>Usage</a></li><li><a href=/docs/express-html-validator/latest/configuration>Configuration</a></li><li><a href=/docs/express-html-validator/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/express-html-validator>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/fallback-dependencies/latest/ >Fallback dependencies</a></summary><ul><li><a href=/docs/fallback-dependencies/latest/usage>Usage</a></li><li><a href=/docs/fallback-dependencies/latest/configuration>Configuration</a></li><li><a href=/docs/fallback-dependencies/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/fallback-dependencies>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/minify-html-attributes/latest/ >HTML attribute minifier</a></summary><ul><li><a href=/docs/minify-html-attributes/latest/usage>Usage</a></li><li><a href=/docs/minify-html-attributes/latest/configuration>Configuration</a></li><li><a href=/docs/minify-html-attributes/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/minify-html-attributes>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/multi-db/latest/ >Multi-DB</a></summary><ul><li><a href=/docs/multi-db/latest/usage>Usage</a></li><li><a href=/docs/multi-db/latest/configuration>Configuration</a></li><li><a href=/docs/multi-db/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/multi-db>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/node-php-runner/latest/ >Node.js PHP runner</a></summary><ul><li><a href=/docs/node-php-runner/latest/usage>Usage</a></li><li><a href=/docs/node-php-runner/latest/configuration>Configuration</a></li><li><a href=/docs/node-php-runner/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/node-php-runner>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/roosevelt-logger/latest/ >Roosevelt logger</a></summary><ul><li><a href=/docs/roosevelt-logger/latest/usage>Usage</a></li><li><a href=/docs/roosevelt-logger/latest/configuration>Configuration</a></li><li><a href=/docs/roosevelt-logger/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/roosevelt-logger>GitHub</a></li></ul></details></li><li><details open><summary><a href=/docs/progressively-enhance-web-components/latest/ ><abbr title="server-side render">SSR</abbr> web components</a></summary><ul><li><a href=/docs/progressively-enhance-web-components/latest/usage>Usage</a></li><li><a href=/docs/progressively-enhance-web-components/latest/configuration>Configuration</a></li><li><a href=/docs/progressively-enhance-web-components/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/progressively-enhance-web-components>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/semantic-forms/latest/ >Semantic Forms</a></summary><ul><li><a href=/docs/semantic-forms/latest/usage>Usage</a></li><li><a href=/docs/semantic-forms/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/semantic-forms>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/single-page-express/latest/ >Single Page Express</a></summary><ul><li><a href=/docs/single-page-express/latest/usage>Usage</a></li><li><a href=/docs/single-page-express/latest/configuration>Configuration</a></li><li><a href=/docs/single-page-express/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/single-page-express>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/source-configs/latest/ >Source Configs</a></summary><ul><li><a href=/docs/source-configs/latest/usage>Usage</a></li><li><a href=/docs/source-configs/latest/configuration>Configuration</a></li><li><a href=/docs/source-configs/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/source-configs>GitHub</a></li></ul></details></li><li><details><summary><a href=/docs/teddy/latest/ >Teddy templating engine</a></summary><ul><li><a href=/docs/teddy/latest/usage>Usage</a></li><li><a href=/docs/teddy/latest/configuration>Configuration</a></li><li><a href=/docs/teddy/latest/changelog>Changelog</a></li><li><a href=https://github.com/rooseveltframework/teddy>GitHub</a></li></ul></details></li></ul></details></nav><nav id=basic-version-picker><p>API version:</p><ul><li><a href=/docs/progressively-enhance-web-components/latest/usage.html>1.0.4 (latest)</a></li><li><a href=https://github.com/rooseveltframework/progressively-enhance-web-components/commits/main/README.md>Older...</a></li></ul></nav><aside><p><small>Except where otherwise noted, all original work available on this site is licensed under the <a href=http://creativecommons.org/licenses/by/4.0/ >Creative Commons Attribution 4.0 International License</a>.</small></p><p><small>Commercial and noncommercial use is permitted so long as <a href=/contributors>the authors</a> of the work are properly attributed.</small></p></aside></footer></main></body></html>